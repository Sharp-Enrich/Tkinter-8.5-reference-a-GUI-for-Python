# 第4节：布局管理

我们稍后讨论GUI应用程序中的组件、构建块。现在先说一下组件是如何在窗口中排列的。

尽管Tkinter中有三种不同的“几何管理器”，但作者强烈倾向于使用`#!python .grid()`几何管理器来处理几乎所有的事情。此管理器将每个窗口或框架视为一个表 —— 即由行列组成的网格。

+ 单元格是一行和一列相交处的区域。
+ 每列的宽度是该列中最宽的单元的宽度
+ 每行的高度是该行最大的单元的高度。
+ 对于没有填满整个单元格的控件，你可以指定如何处理多余的空间。你可以在控件外部留下额外的空间，也可以在水平或垂直维度上拉伸小部件以适应它。
+ 您可以将多个单元组合成一个更大的区域，这个过程称为跨度生成(spanning)。

创建控件时，直到你使用几何管理器注册它，它才会出现。因此，控件的构建和放置是一个两步过程，就像下面这样：

```python title="控件的创建和放置"
self.thing = tk.Constructor(parent, ...)
self.thing.grid(...)
```

其中`#!python Constructor`是一个控件类，如`#!python Button`、`#!python Frame`等，`#!python parent`是父控件，该子控件是在其父控件中构造的。所有控件都有一个`#!python .grid()`方法，你可以使用该方法告诉几何管理器将其放置在何处。

## 4.1 `#!python .grid()`方法

在应用程序屏幕上显示小部件`#python W`:

```python
w.grid(option=value, ...)
``` 
此方法用grid网格几何管理器注册一个控件`#!python w`，如果不这样做，小部件将在内部存在，但在屏幕上不可见。对于`#!python option`,参照下表：

<center>**<small>表 1. `#!python .grid()`几何管理器的参数</small>**</center>

| 参数      | 描述 |
| -------- | -------- |
|`column`|你想要控件安置在网格的列号，从零计数。默认值为零。|
|`columnspan`|通常控件只占用网格中的一个单元格。但是可以通过将`columnspan`选项设置为单元格数来获取一行中的多个单元格,并将它们合并为一个更大的单元格。例如，`#!python w.grid(row=0, column=2, columnspan=3)`将把小部件w放在第0行跨越第2、3、4列的单元格中。|
|`in_`|要将`w`注册为某个控件`w2`的子控件，请使用`in =w2`。新的父控件`w2`必须是创建`w`时使用的父控件的后代。|
|`ipadx`|内部x填充。这个维度被添加到控件的左右两侧。|
|`ipady`|内部填充。这个维度被添加到小部件的顶部和底部边界内。|
|`padx`|外部X填充。该维度被添加到小部件外部的左右右侧。|
|`pady`|外部y填充。该维度在小部件上方和下方添加。|
|`row`|要插入小部件的行号，从0开始计数。默认值是下一个编号较高的未占用行。|
|`rowspan`|通常，小部件只占用网格中的一个单元格。但是，通过将rowspan选项设置为要抓取的单元格数量，可以抓取列的多个相邻单元格。此选项可与columnspan选项结合使用，以获取单元格块。例如，w.grid(row=3, column=2, rowspan=4, columnspan=5)将把小部件w放置在合并20个单元格形成的区域中，行号为36，列号为26。|
|`sticky`|此选项决定如何分配单元格中未被小部件以其自然大小占用的任何额外空间。见下文。|

+ 如果不提供粘性（sticky）属性，则默认行为是将小部件置于单元格的中心。
+ 可以使用Sticky = TK.NE（右上），TK.SE（右下），TK.SW（左下）（左下）或TK.NW（左上方）将小部件放在单元的角落。
+ 可以使用Sticky = TK.N（顶部中心），TK.E（右中间），TK.S（底部中心）或TK.W（左中心）将窗口部件放在单元的一侧。
+ 使用sticky= tk.n+tk.s垂直拉伸小部件，但将其水平居中。
+ 使用sticky= tk.e+tk.w水平拉伸，但垂直保持中心。
+ 使用粘性= tk.n+tk.e+tk.s+tk.w水平和垂直延伸小部件以填充单元格。
+ 其他组合也可以。例如:sticky=tk. n +tk. s +tk。W将垂直拉伸小部件，并将其放置在西(左)墙上。

{++对于以上NSWE可以用地图的上北下南左西右东理解记忆++}



## 4.2 其他网格(grid)管理方法

下面这些与网格相关的方法在所有控件均有定义：

!!! info "w.grid_bbox(column=None, row=None, col2=None, row2=None)"
    返回一个4元组，描述小部件w中部分或全部网格系统的边界框。返回的前两个数字是区域左上角的x和y坐标，后两个数字是宽度和高度。

    如果传入列和行参数，则返回的边界框将描述该列和行处的单元格区域。如果还传入col2和row2参数，则返回的边界框描述网格的区域，从列列到col2包括在内，从行行到行2包括在内。

    例如，w.grid_bbox（0，0，1，1）返回四个单元格的边界框，而不是一个。

!!! info "w.grid_forget()"
    此方法使小部件w从屏幕上消失。它仍然存在，只是看不见而已。您可以使用.grid()让它再次出现，但它不会记住它的网格选项。


!!! info "w.grid_info()"
    返回一个字典，其键是w的选项名，并返回这些选项的对应值。

!!! info "w.grid_location(x, y)"
    给定一个相对于包含小部件的坐标(x, y)，该方法返回一个元组(col, row)，该元组描述w的网格系统中哪个单元格包含该屏幕坐标。

!!! info "w.grid_propagate()"
    通常，所有小部件都会传播它们的尺寸，这意味着它们会调整以适应内容。但是，有时您希望强制一个小部件具有一定的大小，而不管其内容的大小。为此，调用w.grid propagate(0)，其中w是要强制其大小的小部件。

!!! info "w.grid_remove()"
    这个方法类似于.grid forget()，但是它的网格选项被记住了，所以如果您再次使用.grid()，它将使用相同的网格配置选项。

!!! info "w.grid_size()"
    返回一个2元组，其中分别包含w的网格系统中的列数和行数。

!!! info "w.grid_slaves(row=None, column=None)"
    返回由小部件w管理的小部件的列表。如果没有提供参数，您将获得所有托管小部件的列表。使用row=参数只选择一行中的小部件，或者使用column=参数只选择一列中的小部件。



## 4.3 配置行列尺寸

除非您采取某些措施，否则给定小部件内的网格列的宽度将等于其最宽单元格的宽度，网格行的高度将等于其最高单元格的高度。小部件上的sticky属性仅在它没有完全填充单元格的情况下控制它的放置位置。

如果您希望覆盖这种自动调整列和行的大小，请在包含网格布局的父小部件w上使用这些方法

!!! info "w.columnconfigure(N, option=value, ...)"
    在小部件w内的网格布局中，配置列N，使给定选项具有给定值。有关选项，请参见下表。

!!! info "w.rowconfigure(N, option=value, ...)"
    在小部件w内的网格布局中，配置第N行，使给定选项具有给定值。有关选项，请参见下表。

下面是用于配置列和行尺寸的选项。

<center><small>**表 2. `.grid()`几何管理器行列配置选项 **</small></center>

|参数|描述|
|---|---|
|`minsize`|列或行以像素为单位的最小大小。如果给定的列或行中没有任何内容，则即使使用此选项也不会显示。|
|`pad`|将添加到给定列或行上的像素数，位于列或行中最大单元格之上。|
|`weight`|若要使列或行可拉伸，请使用此选项并提供一个值，该值在分配额外空间时给出该列或行的相对权重。例如，如果小部件w包含网格布局，这些线将把四分之三的额外空间分配给第一列，四分之一分配给第二列:`#!python w.columnconfigure(0, weight=3);w.columnconfigure(1, weight=1)`如果未使用此选项，则列或行将不会伸展。|


## 4.4 使根窗口尺寸可变

你是否想让用户调整整个应用程序窗口的大小，并在其内部小部件之间分配额外的空间吗?这需要一些不太明显的操作。

有必要使用第4.3节(配置列和行大小)中描述的行和列大小管理技术，以使你的Application小部件的网格可拉伸。然而，仅靠这一点是不够的。

考虑第2节中讨论的普通应用程序，一个最小的应用程序，它只包含一个{== **<sup>退出</sup>** ==} 按钮。如果运行此应用程序并调整窗口大小，则按钮将保持相同的大小，并位于窗口的中心。

下面是最小应用中的`.__ createwidgets（）`方法的替换版本。在此版本中，{== **<sup>退出</sup>** ==} 按钮始终填充所有可用的空间。

```python title="最小程序.__ createwidgets（）改版"
--8<-- "docs/src/4_1_mininal.py"
```

1. “顶层窗口“是屏幕上最外面的窗口。但是，这个窗口不是您的Application窗口，它是Application实例的父窗口。要获得顶级窗口，请在应用程序中的任何小部件上调用.winfo toplevel()方法;参见第26节，通用小部件方法。
2. 这行使顶层窗口网格的第0行可拉伸。
3. 这行使顶层窗口网格的第0列可拉伸。
4. 使Application小部件的第0行网格可拉伸。
5. 使Application小部件的第0列网格可拉伸。
6. 参数`sticky=tk. n +tk. s +tk. e +tk。W`使按钮展开以填充其网格单元格。

还有一处必须改变。在构造函数中，修改第二行代码，如下所示

```python hl_lines="3"
def __init__(self, master=None):
        super().__init__(master)
        self.grid(sticky=tk.N+tk.S+tk.E+tk.W)
        self.createWidgets()
```

`#!python sticky=tk.N+tk.S+tk.E+tk.aW to self.grid()` 是必要的，这样Application小部件将展开以填充其顶层窗口网格的单元格。